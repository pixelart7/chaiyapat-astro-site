---
import Note from '@layouts/Note.astro'

import path from 'path';
import slugify from 'slugify';

export async function getStaticPaths() {
  const notes = (await Astro.glob('../../markdown/notes/*.md')).filter((post) => !post.frontmatter.draft);
  return notes.map((n) => ({
    params: {
      slug: slugify(path.basename(n.file, '.md'), { lower: true }),
    },
    props: {
      post: n,
      title: path.basename(n.file, '.md'),
      frontmatter: n.frontmatter,
    }
  }));
}

const { Content } = Astro.props.post;
const title = Astro.props.title;
const frontmatter = Astro.props.frontmatter;
---

<Note title={frontmatter?.title || title}>
  <Content/>
</Note>